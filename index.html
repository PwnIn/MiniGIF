<!DOCTYPE html><html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>MiniGIF</title> <meta name="viewport" content="width=device-width, initial-scale=1"> <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script> <script src="https://cdn.bootcss.com/twitter-bootstrap/4.1.3/js/bootstrap.min.js"></script> <script src="https://cdn.bootcss.com/fabric.js/2.4.3/fabric.min.js"></script> <script src="https://cdn.bootcss.com/downloadjs/1.4.8/download.min.js"></script> <script src="https://cdn.bootcss.com/keypress/2.1.5/keypress.min.js"></script> <script src="https://cdn.bootcss.com/gif.js/0.2.0/gif.js"></script> <link href="https://cdn.bootcss.com/twitter-bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet"> <link rel="stylesheet" type="text/css" media="screen" href="/main.8785e071.css"> </head> <body> <div class="container-fluid"> <div class="row">  <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4"> <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"> <h1 class="h2">MiniGIF</h1> </div> <canvas class="w-100" id="myAvatar" width="460" height="460"></canvas> <div class="actionBar"> <button class="btn btn-primary" onclick="downloadit()"> 下载图片 </button> <button class="btn btn-primary" onclick="pic_add()"> 加入动图序列 </button> <button class="btn btn-primary" onclick="pic_build()"> 下载动图 </button> </div> <div class="form-group editBar"> <input type="text" class="form-control" id="theText" placeholder="点击画布中的文字进行修改" disabled onchange="update_text()"> </div> <ul class="gif-images"></ul> </main> </div> </div> </body> <script>var e=new fabric.Canvas("myAvatar",{preserveObjectStacking:!0});e.backgroundColor="rgba(255, 255, 255, 1)",fabric.Image.fromURL("avatar.png",function(t){e.insertAt(t,0),t.set({cornerSize:15,padding:5,transparentCorners:!0,cornerStyle:"circle",cornerColor:"red",borderColor:"red"})});var t=new fabric.Text("Hello?",{left:100,top:100});function r(){$(e.getObjects()).each(function(e,t){"text"==t.type&&t.on("selected",function(){console.log(t),$("#theText").val(t.text),$("#theText").prop("disabled",!1)})})}function n(){var t=$("#theText").val();if(t.length>0){var r=e.getActiveObject();r&&"text"==r.type&&(r.set("text",t),e.renderAll())}}function o(){var t=e.toDataURL("png"),r=$("<li><img src='"+t+"' /></li> ");$(".gif-images").append(r)}function a(){var e=new GIF({workers:2,quality:10,width:460,height:460});$(".gif-images li img").each(function(t,r){e.addFrame(r,{delay:200})}),e.on("finished",function(e){window.open(URL.createObjectURL(e)),download(e,"avatar.gif","image/gif")}),e.render()}function i(){console.log(e.toDataURL("png")),download(e.toDataURL("png"),"avatar.png","image/png")}e.insertAt(t,2),t.set({cornerSize:15,padding:5,transparentCorners:!0,cornerStyle:"circle",cornerColor:"red",borderColor:"red"}),$(function(){var t=new window.keypress.Listener;t.simple_combo("delete",function(){var t=e.getActiveObject();t&&e.remove(t)}),t.simple_combo("]",function(){var t=e.getActiveObject();t&&e.sendBackwards(t)}),t.simple_combo("[",function(){var t=e.getActiveObject();t&&e.bringForward(t)}),r()});</script> </html>